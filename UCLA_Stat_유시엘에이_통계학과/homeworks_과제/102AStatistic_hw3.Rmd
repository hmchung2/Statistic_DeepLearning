---
title: "Stats 102A - Homework 2"
author: "Daniel Chung"
date: "Winter 2019"
output: html_document
---

_Modify this file with your answers and responses. Please preserve all text that is italicized._


# Important:

You will submit two files for this homework assignment.

The first is the rendered HTML with answers to the questions. "102A_hw_02_first_last.html"

The second will be an R script with the code to run the tic-tac-toe game. "102A_ttt_first_last.R"



### Reading

a. Scientific Programming and Simulation Using R (SPURS) - Chapters 3 and 5. See syllabus for link to textbook.
b. Advanced R - Chapter 6 sections 1 through 4

1. _SPURS chapter 3, section 9, exercise 1. [10pts]_

```{r}
f <- function(x){
  if(x <= 0){
    -(x)^3
  }
  else if( x > 0 & x <= 1){
    x^2
  }
    else if( x > 1){
     sqrt(x)
   } 
}


```

```{r, error = TRUE}
# do not modify this code
x_values <- seq(-2, 2, by = 0.1)
y_values <- rep(NA, length(x_values))
for (i in seq_along(x_values)) {
  x <- x_values[i]
  y_values[i] <- f(x)
}

# output
plot(x_values, y_values, type = "l")
```
***At 0, f has derivative, since it is a smooth curve. At 1, f has no derivative, because there is a sharp turn.*** 

2. _SPURS chapter 3, section 9, exercise 2, but write your solution as a function (as specified in chapter 5, section 7, exercise 2) [10pts]_

```{r}
h <- function(x, n){
 h = 0
    for (i in 0:n)
     {
      h = h + x^i;
     }
    print(paste("h(x=",x,",n=",n,")=", h))
}
```

```{r, error = TRUE}
# do not modify this code chunk
# a few test cases
h(1,6)
h(2,7)
h(3,5)
h(10,5)
h(100,4)
h(20,4)
h(-2,7)
h(-2,6)
```

3. _SPURS chapter 3, section 9, exercise 4. [10pts]_

```{r}
h_while <- function(x, n){
  i <- 0
res <- rep(1, n+1)
while (i <= n) {
  res[i+1] <- x^i
  i = i+1
}
print(paste("h(x=",x,",n=",n,")=", sum(res)))
}

```

```{r, error = TRUE}
# do not modify this code chunk
# a few test cases
h_while(1,6)
h_while(2,7)
h_while(3,5)
h_while(10,5)
h_while(100,4)
h_while(20,4)
h_while(-2,7)
h_while(-2,6)
```



```{r}

h_vector <- function(x, n){
  h= rep(x,n+1)
  p = 0:n
  h = h^p 
print(paste("h(x=",x,",n=",n,")=", sum(h)))
}
```

```{r, error = TRUE}
# do not modify this code chunk
# a few test cases
h_vector(1,6)
h_vector(2,7)
h_vector(3,5)
h_vector(10,5)
h_vector(100,4)
h_vector(20,4)
h_vector(-2,7)
h_vector(-2,6)
```

4. _SPURS chapter 3, section 9, exercise 10. [10pts]_

```{r}
my_min <- function(x){
 x.min <- x[1]
  for (i in 2:length(x)) {
   if(x[i] < x.min )
     x.min <- x[i]
 }
  return(x.min)
}

```

```{r, error = TRUE}
# do not modify this code chunk
# a few test cases
my_min(c(5,4,7,5,3,2))
my_min(-c(5,4,7,5,3,2))
```



5. _SPURS chapter 5, section 7, exercise 3, parts a, b, and c. [10pts]_

```{r, error = TRUE}
# write your answer here. I've written a little bit of code to get you started.
# part a
win <- FALSE
 for (i in 1:4) {
 if (sample(1:6, size = 1) == 6) {
 win <- TRUE
 }
   }
 if (win == TRUE) {
 print("win")
 } else if ( win == FALSE) {
 print("lose")
}




# part b
sixes <- function(n=4){
  for (i in 1:n) {
 if (sample(1:6, size = 1) == 6) {
 win <- TRUE
 }
  }
   if(n < 1){
    win <- "n>=1"
  }
 if (win == TRUE) {
 print("win")
 } else if ( win == FALSE) {
 print("lose")
} else if( win == "n>=1")
  print("has to be bigger than or equal to 1")
}
sixes <- function(n = 4) {
 sum(sample(1:6, size = n, replace = TRUE) == 6) > 0
}

# part c
sixes_rep <- function(n=4, r){
  wins <- 0
  for(i in 1:r){
    if (sum(sample(1:6,replace =TRUE , size = n) == 6) > 0)
    wins <- wins + 1 
    }
  obs <- wins / r
  theor <- 1 - (5/6)^n
  difference <- obs - theor
  # the function should print:
  cat("Theoretical prob of at least one six in", n, "dice is:", theor, "\n")
  cat("Empirical prob of at least one six after", r,"replications is:", obs, "\n")
  cat("the difference is", difference ,"\n")
  return(difference)
}


# Sample output:
# Theoretical prob of at least one six in 4 dice is: 0.5177469 
# Empirical prob of at least one six after 10000 replications is: 0.5175 
# the difference is -0.0002469136 
```

```{r, error = TRUE}
# do not modify this code chunk
# a few test cases to see if your code works
set.seed(1)
sixes_rep(4, 100)
sixes_rep(4, 100)
sixes_rep(4, 1000)
sixes_rep(4, 1000)
sixes_rep(4, 1000)
sixes_rep(4, 10000)
sixes_rep(4, 10000)
sixes_rep(4, 10000)
```


